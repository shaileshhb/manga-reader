import{a as $,b as j}from"./chunk-BSMKYY3J.js";import{A as d,Da as O,Ea as p,Ha as a,Ia as i,Ja as U,Ma as E,Na as R,Oa as f,Q as l,Ta as o,Ua as k,V as I,Va as S,W as m,Y as c,Ya as u,Za as L,_a as F,a as M,ea as T,fa as P,q as y,sa as _,sb as D,tb as B,ua as s,ub as H,vb as h,za as g}from"./chunk-M4URV6HP.js";var q={production:!1,apiBaseUrl:""};var v=class n{constructor(e){this.http=e}baseUrl=q.apiBaseUrl??"";get(e,t){return this.http.get(this.url(e),{headers:this.headers(t)}).pipe(d(this.handleError))}post(e,t,r){return this.http.post(this.url(e),t,{headers:this.headers(r)}).pipe(d(this.handleError))}put(e,t,r){return this.http.put(this.url(e),t,{headers:this.headers(r)}).pipe(d(this.handleError))}patch(e,t,r){return this.http.patch(this.url(e),t,{headers:this.headers(r)}).pipe(d(this.handleError))}delete(e,t){return this.http.delete(this.url(e),{headers:this.headers(t)}).pipe(d(this.handleError))}url(e){return this.baseUrl?`${this.baseUrl}${e}`:e}headers(e){let r=M(M({},{"Content-Type":"application/json"}),e?.headers??{});return new $(r)}handleError(e){let t=new Error("API request failed");return t.status=e.status,t.data=e.error,y(()=>t)}static \u0275fac=function(t){return new(t||n)(I(j))};static \u0275prov=l({token:n,factory:n.\u0275fac,providedIn:"root"})};var x=class n{api=m(v);getAllManga(){return this.api.get("/api/manga")}static \u0275fac=function(t){return new(t||n)};static \u0275prov=l({token:n,factory:n.\u0275fac,providedIn:"root"})};function V(n,e="cbz"){return(String(n||"manga").replace(/\.[^/.]+$/,"").replace(/[^a-z0-9 _.-]+/gi,"").replace(/\s+/g," ").trim().slice(0,120)||"manga").toString().replace(/\.$/,"")+`.${e}`}var z=n=>`/api/manga/${encodeURIComponent(n)}/read`,A=(n,e)=>`/api/manga/${encodeURIComponent(n)}/download?filename=${encodeURIComponent(V(e))}`;function J(n,e){n&1&&(a(0,"div",3),o(1,"Loading manga\u2026"),i())}function K(n,e){if(n&1){let t=E();a(0,"div",4)(1,"p",5),o(2,"Unable to load manga right now."),i(),a(3,"button",6),R("click",function(){T(t);let N=f();return P(N.reload())}),o(4,"Retry"),i()()}}function Q(n,e){n&1&&(a(0,"div",3),o(1," No manga available. "),i())}function W(n,e){if(n&1&&(a(0,"div",9)(1,"h3",10),o(2),i(),a(3,"div",11)(4,"span"),o(5),L(6,"number"),i()(),a(7,"div",12)(8,"a",13),o(9,"Read"),i(),a(10,"a",14),o(11,"Download"),i()()()),n&2){let t=e.$implicit,r=f(2);s(),p("title",t.name),s(),k(t.name),s(3),S("",F(6,5,t.size||0)," bytes"),s(3),p("href",t.readUrl||r.readUrl(t),_),s(2),p("href",t.downloadUrl||r.downloadUrl(t),_)}}function X(n,e){if(n&1&&(a(0,"div",7),O(1,W,12,7,"div",8),i()),n&2){let t=f();s(),p("ngForOf",t.items())("ngForTrack",t.item.id)}}var b=class n{service=m(x);items=g([]);loading=g(!0);error=g(null);constructor(){this.load()}readUrl(e){return z(e.id)}downloadUrl(e){return A(e.id,e.name)}reload=()=>this.load();load(){this.loading.set(!0),this.error.set(null),this.service.getAllManga().subscribe({next:e=>{this.items.set(Array.isArray(e)?e:[]),this.loading.set(!1)},error:()=>{this.error.set("Unable to load manga right now."),this.loading.set(!1)}})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=c({type:n,selectors:[["app-manga-list"]],standalone:!0,features:[u],decls:4,vars:4,consts:[["class","padded center muted",4,"ngIf"],["class","padded center",4,"ngIf"],["class","grid",4,"ngIf"],[1,"padded","center","muted"],[1,"padded","center"],[1,"error"],["type","button",3,"click"],[1,"grid"],["class","card",4,"ngFor","ngForOf","ngForTrack"],[1,"card"],[3,"title"],[1,"meta"],[1,"actions"],["target","_blank","rel","noopener noreferrer",3,"href"],[3,"href"]],template:function(t,r){t&1&&O(0,J,2,0,"div",0)(1,K,5,0,"div",1)(2,Q,2,0,"div",0)(3,X,2,2,"div",2),t&2&&(p("ngIf",r.loading()),s(),p("ngIf",r.error()),s(),p("ngIf",!r.loading()&&!r.error()&&!r.items().length),s(),p("ngIf",!r.loading()&&!r.error()&&r.items().length))},dependencies:[h,D,B,H],styles:[".padded[_ngcontent-%COMP%]{padding:16px}.center[_ngcontent-%COMP%]{text-align:center}.muted[_ngcontent-%COMP%]{color:#9ca3af}.error[_ngcontent-%COMP%]{color:#ef4444;margin-bottom:8px}.grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(1,minmax(0,1fr));gap:16px;padding:16px}@media (min-width: 640px){.grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,minmax(0,1fr))}}@media (min-width: 1024px){.grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,minmax(0,1fr))}}.card[_ngcontent-%COMP%]{border:1px solid #404040;border-radius:12px;padding:16px;background:#0006;color:#fff}h3[_ngcontent-%COMP%]{margin:0;font-weight:600;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.meta[_ngcontent-%COMP%]{margin-top:4px;color:#9ca3af;font-size:12px}.actions[_ngcontent-%COMP%]{display:flex;gap:8px;margin-top:12px}.actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding:6px 10px;border-radius:8px;text-decoration:none;color:#fff;background:#1f2937}.actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:last-child{background:#dc2626}.actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:last-child:hover{background:#ef4444}"]})};var C=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=c({type:n,selectors:[["app-manga-list-page"]],standalone:!0,features:[u],decls:5,vars:0,consts:[[1,"page"],[1,"container"]],template:function(t,r){t&1&&(a(0,"div",0)(1,"div",1)(2,"h1"),o(3,"Manga Library"),i(),U(4,"app-manga-list"),i()())},dependencies:[h,b],styles:[".page[_ngcontent-%COMP%]{min-height:100vh;background:#000}.container[_ngcontent-%COMP%]{max-width:1024px;margin:0 auto;padding:32px 16px}h1[_ngcontent-%COMP%]{color:#fff;margin:0 0 16px;font-size:24px;font-weight:700}"]})};var Ie=[{path:"",component:C}];export{Ie as MANGA_ROUTES};
